<ion-view title="Session Setup">
    <ion-content class="has-header container" overflow-scroll="true" padding="true">
        
        <div class="spacer spacer-10"></div>
        <div class="row">
            <div class="col col-33">
            </div>
            <div class="col col-33 text-center">
                <h2>Observation Settings</h2>
            </div>
            <div class="col col-33 text-right">
                <a ng-click="showHelp=!showHelp"><i class="ion-help-circled help"></i></a>
            </div>
        </div>
        <!--session setup progress-->
        <div class="breadcrumb center">            
            <i class="ion-ios-circle-outline"></i>
            <i class="ion-ios-circle-outline"></i>
            <i class="ion-ios-circle-filled"></i>
        </div> 
        <div class="spacer spacer-20"></div>

        <!-- Help section-->
        <div ng-model="showHelp" ng-show="showHelp" class="card">
            <div class="container">
                <div class="row border-bottom">
                    <div class="col col-33">
                    </div>
                    <div class="col col-33 col-bottom text-center">
                        <h3>Help Topics</h3> 
                    </div>
                    <div class="col col-33 col-center text-right">
                        <a class="button button-icon icon ion-close-circled" ng-click="showHelp = false"></a>
                    </div>
                </div>
                <div class="spacer spacer-10"></div>
                <div class="row item-divider expando-pane">
                    <div class="col col-center"><h4>General</h4></div>
                    <div class="col col-center text-right">
                        <a ng-class="{'button button-small button-icon icon ion-ios-plus-outline':!genHelp, 'button button-small button-icon icon ion-ios-minus-outline':genHelp}" ng-click="genHelp=!genHelp"></a>
                    </div>
                </div>
                <div ng-model="genHelp" ng-show="genHelp" class="container">
                    <div class="spacer spacer-10"></div>
                    <p>Fill in the fields below in order to finish setting up your session, then press the Start Session button below to begin.</p>
                    <div class="spacer spacer-10"></div>
                </div>

                <div class="row item-divider expando-pane">
                    <div class="col col-center"><h4>Focal and Scanning</h4></div>
                    <div class="col col-center text-right">
                        <a ng-class="{'button button-small button-icon icon ion-ios-plus-outline':!focalHelp, 'button button-small button-icon icon ion-ios-minus-outline':focalHelp}" ng-click="focalHelp=!focalHelp"></a>
                    </div>
                </div>
                <div ng-model="focalHelp" ng-show="focalHelp" class="container">
                    <div class="spacer spacer-10"></div>                    
                    <h3>Focal:</h3>
                    <p>One hour focal observation sessions begin with a summary of the activities occurring in each zone (refer to Excel datasheet file for focal samples). The observer will use comments to provide a brief overview of the selected focal bear(s) and human behaviours and note the mean distance between bears and people. Next, the observer will fill out the appropriate datasheet beginning with the general datasheet (Appendix I) followed by the focal and opportunistic datasheets (Appendix II). Bear behaviour recorded during focal observations includes:</p>
                    <ul>
                        <li>Bear species</li>
                        <li>Sex and age class</li>
                        <li>Identification or description of individual</li>
                        <li>Bear location</li>
                        <li>Bear activity: arrival time, departure time</li>
                        <li>Number of bears present</li>
                        <li>Location of bears present</li>
                        <li>Activityofthefocalbear(s)(seebearbehaviourkeyforexplanations)</li>
                    </ul>
                    <p>Dependent upon the activity of the focal bear(s) the observer will then fill in the appropriate corresponding datasheets. For example, if the focal bear is fishing the fish capture datasheet will be filled in; however, if a jet boat is approaching then the human behaviour observation sampling datasheet would be filled in because it contains information on the distances (e.g., between bears and people) and behavioural response to stimuli (e.g., jet boats, aircrafts, vehicles).</p>
                    <p><em>Potential interactions with humans and behavioural response to stimuli should always take precedent over gathering other data, such as fish captures!</em></p>
                 

                    <h3>Scanning:</h3>
                    <p>In order to reduce the overall observation recording time (currently recommended at 5 daylight hours plus nocturnal monitoring) scan sampling should occur within the focal observation on the 1⁄4 hour (i.e., 13:15, 13:20, and 13:45). A timer should be set to 15-minute intervals at which time the observer visually scans all designated zones. Scan sampling allows for a snapshot of what is happening within all zones during the focal sampling period. For example, scan samples are used to obtain relative measures of visitor and bear activity (i.e., count data such as the number of people within the focal observation (Olson et al. 1998, Chi et al. 1998). Data gathered during scan sampling includes:</p>
                    <ul>
                        <li>Visitor numbers by zone and east and west river banks o Bear numbers by zone and east and west river banks</li>
                        <li>Classification of human activities</li>
                        <li>Classification of bear activities</li>
                        <li>Presence or absence of non-natural attractants</li>
                        <li>Raw catch data of fish only – i.e., observed fish captures recorded (Nevis 2003) - (may also be recorded under focal sampling)</li>
                    </ul>
                    <div class="spacer spacer-10"></div>
                </div>

                <div class="row item-divider expando-pane">
                    <div class="col col-center"><h4>Timers</h4></div>
                    <div class="col col-center text-right">
                        <a ng-class="{'button button-small button-icon icon ion-ios-plus-outline':!timerlHelp, 'button button-small button-icon icon ion-ios-minus-outline':timerHelp}" ng-click="timerHelp=!timerHelp"></a>
                    </div>
                </div>
                <div ng-model="timerHelp" ng-show="timerHelp" class="container">
                    <div class="spacer spacer-10"></div>                    
                    <h3>Focal:</h3>
                    <p>Set this timer for the desired session length.</p>
                 

                    <h3>Scanning:</h3>
                    <p>Set the desired session length and define the amount of time (in minutes) you plan to spend capturing data and resting.</p>
                    <p>Example: scan sampling should occur within the focal observation on the 1⁄4 hour (i.e., 13:15, 13:20, and 13:45). A timer should be set to 15-minute intervals at which time the observer visually scans all designated zones.</p>
                    <div class="spacer spacer-10"></div>
                </div>

            </div>
            <div class="spacer spacer-20"></div>            
        </div><!--End Help-->

        <form name="obsForm" novalidate  ng-submit="saveSession(obsForm)" class="list">

    		<label class="list">
                <ion-item class="item-divider list-head" ng-class="{ 'has-errors' : (submitted && obsForm.observationMode.$invalid), 'no-errors' : (submitted && obsForm.observationMode.$valid)}">Mode</ion-item>
                <ion-radio name="observationMode" ng-model="Session.observationMode" value="Focal" ng-required="Session.observationMode == ''">Focal</ion-radio>
                <ion-radio name="observationMode" ng-model="Session.observationMode" value="Scanning" ng-required="Session.observationMode == ''">Scanning</ion-radio>
            </label>
            <div class="error-container" ng-show="submitted && obsForm.observationMode.$error" ng-messages="obsForm.observationMode.$error">
                <div ng-messages-include="error-list.html"></div> 
            </div>
            <div class="spacer spacer-20"></div>
            <label class="list">
                <ion-item class="item-divider list-head" ng-class="{ 'has-errors' : (submitted && obsForm.surveySched.$invalid), 'no-errors' : (submitted && obsForm.surveySched.$valid)}">Survey Schedule</ion-item>
                <ion-radio name="surveySched" ng-model="Session.surveySched" value="Planned" ng-required="Session.surveySched == ''">Planned</ion-radio>
                <ion-radio name="surveySched" ng-model="Session.surveySched" value="Opportunistic" ng-required="Session.surveySched == ''">Opportunistic</ion-radio>
            </label>
            <div class="error-container" ng-show="submitted && obsForm.surveySched.$error" ng-messages="obsForm.surveySched.$error">
                <div ng-messages-include="error-list.html"></div> 
            </div>

            <!--Focal timer info-->
            <div ng-show="Session.observationMode == 'Focal'">
                <div class="spacer spacer-20"></div>
                <ion-item class="item-divider list-head">Session Length</ion-item>
                <div class="item item-input-inset" ng-class="{ 'has-errors' : (submitted && ((Session.hr == undefined && Session.min == undefined) || obsForm.hr.$invalid || obsForm.min.$invalid)), 'no-errors' : (submitted && obsForm.hr.$valid && obsForm.min.$valid && (Session.hr != undefined || Session.min != undefined))}">
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Hours:</span>
                    <input type="number" name="hr" ng-model="Session.hr" max="24">
                    </label>
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Minutes:</span>
                    <input type="number" name="min" ng-model="Session.min" max="59">
                    </label>
                </div>
 
                <div class="error-container" ng-show="submitted && Session.hr == undefined && Session.min == undefined && obsForm.hr.$valid && obsForm.min.$valid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Session length is required!
                    </div>
                </div>
                <div class="error-container" ng-show="submitted && obsForm.hr.$invalid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Maximum 24 hours - only numbers are accepted!
                    </div>
                </div>
                <div class="error-container" ng-show="submitted && obsForm.min.$invalid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Maximum 59 minutes - only numbers are accepted!
                    </div>
                </div>
            </div><!--End Focal timer-->

            <!--Scanning timer info-->
            <div ng-show="Session.observationMode == 'Scanning'">
                <div class="spacer spacer-20"></div>
                <ion-item class="item-divider list-head">Session length</ion-item>
                <div class="item item-input-inset" ng-class="{ 'has-errors' : (submitted && ((Session.hr == undefined && Session.min == undefined) || obsForm.hr.$invalid || obsForm.min.$invalid)), 'no-errors' : (submitted && obsForm.hr.$valid && obsForm.min.$valid && (Session.hr != undefined || Session.min != undefined))}">
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Hours:</span>
                    <input type="number" name="hr" ng-model="Session.hr" max="24">
                    </label>
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Minutes:</span>
                    <input type="number" name="min" ng-model="Session.min" max="59">
                    </label>
                </div>

                <div class="error-container" ng-show="submitted && Session.hr == undefined && Session.min == undefined && obsForm.hr.$valid && obsForm.min.$valid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Session length is required!
                    </div>
                </div>
                <div class="error-container" ng-show="submitted && obsForm.hr.$invalid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Maximum 24 hours - only numbers are accepted!
                    </div>
                </div>
                <div class="error-container" ng-show="submitted && obsForm.min.$invalid">
                    <div class="error">
                        <i class="ion-alert-circled"></i> 
                        Maximum 59 minutes - only numbers are accepted!
                    </div>
                </div>
                <div class="spacer spacer-10"></div>
                <ion-item class="item-divider list-head">Scanning Timers</ion-item>
                <div class="item item-input-inset" ng-class="{ 'has-errors' : (submitted && (obsForm.resting.$invalid || obsForm.active.$invalid)), 'no-errors' : (submitted && (obsForm.resting.$valid && obsForm.active.$valid))}">
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Active time:</span>
                    <input type="number" name="active" ng-model="Session.active" placeholder="(minutes)" max="60" ng-required="Session.observationMode == 'Scanning'" ng-messages="obsForm.active.$error">
                    </label>
                    <label class="item item-input-wrapper">     
                    <span class="input-label">Resting time:</span>
                    <input type="number" name="resting" ng-model="Session.resting" placeholder="(minutes)" max="60" ng-required="Session.observationMode == 'Scanning'" ng-messages="obsForm.resting.$error">
                    </label>
                </div>

                <div class="row">                
                    <div class="error-container col" ng-show="submitted && obsForm.active.$error" ng-messages="obsForm.active.$error">
                        <div ng-messages-include="error-list.html"></div> 
                    </div>
                    <div class="error-container col" ng-show="submitted && obsForm.resting.$error" ng-messages="obsForm.resting.$error">
                        <div ng-messages-include="error-list.html"></div> 
                    </div>
                </div>
            </div><!--End Scanning timer-->


    		<button class="button button-balanced button-block icon ion-log-in" type="submit">&nbsp; Start Session</button>
            <div ng-show="true">
                <a class="button button-positive  button-block icon-right ion-android-arrow-forward" ui-sref="tab.bear">Skip Validation</a>
            </div>
        </form><!--End obsForm-->
        <div class="spacer spacer-40"></div>
    </ion-content>
</ion-view>
<!--generic error messages-->
<script id="error-list.html" type="text/ng-template">  
    <div class="error" ng-message="required">
        <i class="ion-alert-circled"></i> 
        The field above is required!
    </div>
    <div class="error" ng-message="number">
        <i class="ion-alert-circled"></i> 
        Only numeric values accepted!
    </div>
    <div class="error" ng-message="max">
        <i class="ion-alert-circled"></i> 
        Maximum 60 Minutes for resting or active!
    </div>
  </div>
</script> 